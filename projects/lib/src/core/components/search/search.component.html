<!-- Label -->
@if (label()) {
  <label>
    {{ label() }}
  </label>
}

@let withoutOptions = !options() || options().length === 0;

@if (!value()) {
  <section [class.large]="withoutOptions">
    <!-- Input -->
    <input
      #input
      [value]="inputTextValue()"
      [placeholder]="placeholder() || ''"
      [disabled]="disabled()"
      (focus)="focused.set(true)"
      (blur)="focused.set(false)"
      (input)="onInputValueChange($event)" />

    <!-- Clear Button -->
    @if (inputTextValue() || value()) {
      <i r-icon icon="X" [size]="18" (click)="inputTextValue.set('')"></i>
    }
  </section>
}

<!-- Select -->
<select
  #select
  [value]="selectValue()"
  [style.display]="withoutOptions ? 'none' : 'block'"
  (change)="onSelectValueChange($event)"
  (mousedown)="isOpen.set(true)"
  [disabled]="disabled()"></select>

<!-- Icon -->
<div class="icon-wrapper">
  <i
    r-icon
    [style.display]="withoutOptions ? 'none' : 'flex'"
    [icon]="searching() ? 'LoaderCircle' : value() ? 'X' : 'ChevronDown'"
    [class.open]="isOpen() && !value()"
    [style.pointer-events]="value() ? 'auto' : 'none'"
    [style.cursor]="value() ? 'pointer' : 'default'"
    [style.transition]="value() ? 'none' : 'transform 0.2s'"
    (click)="handleIconClick()"
    [class.searching]="searching()"
    [size]="searching() ? 17 : value() ? 18 : 20"
    [color]="
      invalid()
        ? 'var(--error-foreground, #c40000ab)'
        : ' var(--input-foreground, #798194)'
    "></i>
</div>

<!-- Projected Options -->
<ng-content />
